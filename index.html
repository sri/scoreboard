<!DOCTYPE html>
<html lang="en">
<head>
<title>Scoreboard</title>
<style type="text/css">
body {
  background: black;
  color: #fff;
}
.container {
  display: flex;
}
.team {
  flex: 1;
  text-align:center;
}
.team:first-child {
  margin-right: 20px;
}
.boxscore {
  border: 1px solid #fff;
  width: 400px;
}
.teamname {
  font-size: 40pt;
}
.score {
  font-size: 122pt;
}
.clock {
  flex: 1;
  color: red;
  font-weight: bold;
  text-align: center;
}
.gameclock {
  font-size: 54pt;
}
.shotclock {
  font-size: 44pt;
}
.fouls {
  font-size: 30pt;
}
.timeouts {
  font-size: 30pt;
}
.paused {
  border: 1px solid red;
}
.quarter, .overtime {
  font-size: 30pt;
}
.hidden {
  display: none;
}
</style>
<script type="text/javascript">
var MINS_PER_QUARTER = 6;
var MINS_PER_OVERTIME = 3;

function asInt(elt) {
  const value = parseInt(elt.innerHTML, 10);
  if (isNaN(value)) {
    return 0;
  }
  return value;
}

class Team {
  constructor(eltName) {
    this.elt = document.querySelector(eltName);
    this.scoreElt = this.elt.querySelector(".score");

    this.elt.onclick = () => this.incrementScore();
  }

  getCurrentScore() {
    return asInt(this.scoreElt);
  }

  incrementScore() {
    let currentScore = asInt(this.scoreElt);
    currentScore += 1;
    this.scoreElt.innerHTML = currentScore + "";
  }
}

class Clock {
  constructor(eltName) {
    this.elt = document.querySelector(eltName);
    this.shotclockElt = this.elt.querySelector(".shotclock");

    this.gameClockElt = this.elt.querySelector(".gameclock");
    this.gameClockMinsElt = this.gameClockElt.querySelector(".mins");
    this.gameClockSecsElt = this.gameClockElt.querySelector(".secs");

    this.quarterElt = this.elt.querySelector(".quarter");
    this.quarterCurrentElt = this.quarterElt.querySelector(".current");
    this.overtimeElt = this.elt.querySelector(".overtime");
    this.overtimeCurrentElt = this.overtimeElt.querySelector(".current");

    this.paused = true;
  }

  togglePause() {
    this.paused = !this.paused;
    if (this.paused) {
      this.elt.classList.add("paused")
    } else {
      this.elt.classList.remove("paused")
    }
  }

  updateClock() {
    let mins = asInt(this.gameClockMinsElt);
    let secs = asInt(this.gameClockSecsElt);

    secs -= 1;

    let shotclock = asInt(this.shotclockElt);
    if (mins === 0 && secs <= 24) {
      // If game clock < 24, don't show shot clock.
      shotclock = "-";
    } else {
      shotclock -= 1;
    }
    if (shotclock < 0) {
      shotclock = 24;
    }
    this.shotclockElt.innerHTML = shotclock;

    if (secs < 0) {
      mins -= 1;
      secs = 59;
    }
    if (mins < 0) {
      let quarter = asInt(this.quarterCurrentElt);
      if (quarter < 4) {
        quarter += 1;
        mins = MINS_PER_QUARTER;
        secs = 0;
        this.quarterCurrentElt.innerHTML = quarter;
      } else if (HOME.getCurrentScore() === AWAY.getCurrentScore()) {
        // Overtime
        this.quarterElt.classList.add("hidden");
        this.overtimeElt.classList.remove("hidden");

        let overtime = asInt(this.overtimeCurrentElt) + 1;
        mins = MINS_PER_OVERTIME;
        secs = 0;
        this.overtimeCurrentElt.innerHTML = overtime;
      } else {
        // Game over -- we don't stop the interval that keeps
        // calling this method. If score at some point becomes the same,
        // overtime starts (buzzer beater occurs, and a few seconds later,
        // after a "review", score is incremented).
        return;
      }
    }
    this.gameClockMinsElt.innerHTML = this.format2digit(mins);
    this.gameClockSecsElt.innerHTML = this.format2digit(secs);
  }

  format2digit(n) {
    if (n < 10) return '0' + n;
    return n;
  }

  update() {
    if (!this.paused) {
      this.updateClock();
    }
  }

  start() {
    setInterval(() => this.update(), 1000);
  }
}

var CLOCK;
var HOME;
var AWAY;

function Start() {
  CLOCK = new Clock(".clock");
  CLOCK.start();

  HOME = new Team(".hometeam");
  AWAY = new Team(".awayteam");
}

function Pause() {
  CLOCK.togglePause();
}

function Score() {
}

</script>
</head>
<body onload="Start()">
  <div class="container">
    <div class="team hometeam">
      <div class="boxscore">
        <div class="teamname">Houston Rockets</div>
        <div class="score">0</div>
        <div class="fouls">Fouls:</div>
        <div class="timeouts">Timeouts:</div>
      </div>
    </div>

    <div class="clock paused" onClick="Pause()">
      <div class="gameclock">
        <span class="mins">10</span>:<span class="secs">00</span>
      </div>
      <div class="shotclock">24</div>
      <div class="quarter">Quarter <span class="current">1</span></div>
      <div class="overtime hidden">Overtime <span class="current">0</span></div>
    </div>


    <div class="team awayteam">
      <div class="boxscore">
        <div class="teamname">Sacremento Kings</div>
        <div class="score">0</div>
        <div class="fouls">Fouls:</div>
        <div class="timeouts">Timeouts:</div>
      </div>
    </div>
  </div>

</body>
</html>
